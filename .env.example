# Context Vault - Environment Variables
# Copy this file to .env and fill in your actual values

# ============================================================================
# APPLICATION
# ============================================================================

# Environment: development, staging, production
ENVIRONMENT=development

# Application secret key (used for encryption key derivation)
# Generate with: openssl rand -base64 32
APP_SECRET_KEY=REPLACE_WITH_RANDOM_32_BYTE_KEY

# JWT secret key (for signing access tokens)
# Generate with: openssl rand -base64 32
JWT_SECRET_KEY=REPLACE_WITH_RANDOM_32_BYTE_KEY

# JWT expiration times
ACCESS_TOKEN_EXPIRE_MINUTES=30
REFRESH_TOKEN_EXPIRE_DAYS=30

# ============================================================================
# DATABASE
# ============================================================================

# Development (Railway Postgres)
DATABASE_URL=postgresql://user:password@host:5432/database_name

# Production: Same as above (Railway)
# Alternative for local dev:
# DATABASE_URL=postgresql://localhost/contextvault_dev

# ============================================================================
# GOOGLE OAUTH
# ============================================================================

GOOGLE_OAUTH_CLIENT_ID=your-client-id.apps.googleusercontent.com
GOOGLE_OAUTH_CLIENT_SECRET=GOCSPX-your-client-secret

# Redirect URI (update for your environment)
# Development:
GOOGLE_OAUTH_REDIRECT_URI=http://localhost:8000/api/auth/google/callback
# Production:
# GOOGLE_OAUTH_REDIRECT_URI=https://contextvault-api.onrender.com/api/auth/google/callback

# ============================================================================
# EPIC FHIR (SMART ON FHIR)
# ============================================================================

# Epic Sandbox credentials
EPIC_CLIENT_ID=your-epic-client-id
EPIC_CLIENT_SECRET=  # Optional - only for confidential clients (not needed for PKCE)
EPIC_ISSUER=https://fhir.epic.com/interconnect-fhir-oauth/oauth2
EPIC_FHIR_BASE=https://fhir.epic.com/interconnect-fhir-oauth/api/FHIR/R4

# Redirect URI (update for your environment)
# Development (for fastapi_epic_smart.py MVP):
EPIC_REDIRECT_URI=http://localhost:8000/callback
# Future backend:
# EPIC_REDIRECT_URI=http://localhost:8000/api/integrations/epic/callback
# Production:
# EPIC_REDIRECT_URI=https://contextvault-api.onrender.com/api/integrations/epic/callback

# Epic scopes (space-separated)
EPIC_SCOPES=openid profile patient/Patient.read patient/Observation.read offline_access

# Log path for Epic integration (optional)
EPIC_SMART_LOG_PATH=app.log

# ============================================================================
# FITBIT (Future)
# ============================================================================

# FITBIT_CLIENT_ID=your_fitbit_client_id
# FITBIT_CLIENT_SECRET=your_fitbit_client_secret
# FITBIT_REDIRECT_URI=http://localhost:8000/api/integrations/fitbit/callback

# ============================================================================
# OLLAMA (LOCAL LLM)
# ============================================================================

# Ollama server URL
# Development (local):
OLLAMA_HOST=http://localhost:11434
# Production (hosted Ollama):
# OLLAMA_HOST=https://your-ollama-instance.com

# Default model
DEFAULT_MODEL=llama3.1:8b

# Ephemeral container settings
EPHEMERAL_CONTAINER_ENABLED=false  # Set to true when Docker orchestration ready
CONTAINER_POOL_SIZE=2
CONTAINER_MAX_LIFETIME_REQUESTS=10
CONTAINER_MEMORY_LIMIT=4g

# ============================================================================
# CORS
# ============================================================================

# Allowed origins (comma-separated)
# Development:
ALLOWED_ORIGINS=http://localhost:5173,http://localhost:3000
# Production:
# ALLOWED_ORIGINS=https://contextvault.vercel.app

# ============================================================================
# FILE STORAGE
# ============================================================================

# Local storage path for encrypted files
FILE_STORAGE_PATH=./data/uploads

# Max file size (bytes)
MAX_FILE_SIZE_BYTES=10485760  # 10MB

# ============================================================================
# REDIS (Future - for caching and background jobs)
# ============================================================================

# REDIS_URL=redis://localhost:6379/0
# REDIS_PASSWORD=

# ============================================================================
# LOGGING
# ============================================================================

# Log level: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_LEVEL=INFO

# Log format: json or text
LOG_FORMAT=json

# ============================================================================
# RATE LIMITING
# ============================================================================

RATE_LIMIT_ENABLED=true
RATE_LIMIT_AUTH_PER_MINUTE=10
RATE_LIMIT_VAULT_PER_MINUTE=100
RATE_LIMIT_CHAT_PER_MINUTE=20
RATE_LIMIT_UPLOAD_PER_MINUTE=10

# ============================================================================
# FRONTEND ENVIRONMENT VARIABLES (VITE)
# ============================================================================

# These are used by the frontend (prefix with VITE_)
# Add to Vercel environment variables

# Backend API URL
VITE_API_BASE_URL=http://localhost:8000
# Production:
# VITE_API_BASE_URL=https://contextvault-api.onrender.com

# Google OAuth Client ID (public, safe to expose)
VITE_GOOGLE_OAUTH_CLIENT_ID=your-client-id.apps.googleusercontent.com

# Enable debug mode (shows extra logs in console)
VITE_DEBUG_MODE=false

# Jira Configuration
JIRA_EMAIL=davidjmorgan26@gmail.com
JIRA_SPACE=ContextVault
JIRA_BASE_URL=https://davidjmorgan26.atlassian.net/
JIRA_API_TOKEN=replace-with-real-api-token


# ============================================================================
# SECURITY NOTES
# ============================================================================

# 1. NEVER commit .env files to git (add to .gitignore)
# 2. Rotate APP_SECRET_KEY and JWT_SECRET_KEY annually
# 3. Use different secrets for dev/staging/production
# 4. Store production secrets in Render/Vercel dashboards, not in files
# 5. Database password should be strong (Railway generates secure passwords)
# 6. Google OAuth client secret should never be exposed to frontend
